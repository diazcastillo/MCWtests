<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bias-measures Monte Carlo-Wilcoxon (bMCW) Test — bMCWtest • MCWtests</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bias-measures Monte Carlo-Wilcoxon (bMCW) Test — bMCWtest"><meta name="description" content="The bMCW test is a statistical tool to assess whether a set of measures of bias for a quantitative trait between two conditions or a subset of these bias measures are themselves significantly biased in the same direction. For instance, bMCW tests can be used to analyze bias indexes obtained using other MCW tests or fold change for transcript abundances spanning the entire transcriptome or only for genes located in specific genomic regions from two sets of mice exposed to different conditions."><meta property="og:description" content="The bMCW test is a statistical tool to assess whether a set of measures of bias for a quantitative trait between two conditions or a subset of these bias measures are themselves significantly biased in the same direction. For instance, bMCW tests can be used to analyze bias indexes obtained using other MCW tests or fold change for transcript abundances spanning the entire transcriptome or only for genes located in specific genomic regions from two sets of mice exposed to different conditions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MCWtests</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MCWtests.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/diazcastillo/MCWtests/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bias-measures Monte Carlo-Wilcoxon (bMCW) Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/diazcastillo/MCWtests/blob/main/R/bMCWtest.R" class="external-link"><code>R/bMCWtest.R</code></a></small>
      <div class="d-none name"><code>bMCWtest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The bMCW test is a statistical tool to assess whether a set of measures of bias for a quantitative trait between two conditions or a subset of these bias measures are themselves significantly biased in the same direction. For instance, bMCW tests can be used to analyze bias indexes obtained using other MCW tests or fold change for transcript abundances spanning the entire transcriptome or only for genes located in specific genomic regions from two sets of mice exposed to different conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bMCWtest</span><span class="op">(</span><span class="va">path</span>, <span class="va">max_rearrangements</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>When executing the <em>bMCWtest</em> function, users must provide the path to a local CSV file named <em>X_bMCWtest_data.csv</em>, where <em>X</em> serves as a user-defined identifier. <em>X_bMCWtest_data.csv</em> should include the following columns:</p><ul><li><p>Column <em>bias_value</em> contains the value of the bias measure under analysis.</p></li>
<li><p>Columns <em>subset_x</em>, where <em>x</em> represents the specific type of subset for each column, such as "chr" for chromosomes or "GO" for Gene Ontology. These columns are required if users intend to assess whether bias measures for certain subsets of elements in the dataset are significantly biased in the same direction. Columns <em>subset_x</em> can indicate whether an element belongs to a subset using either "YES" and "NO", or specific subset names like "chr1" or "chrX", or a combination of both, such as "chr1", "chrX" and "NO". The function <em>bMCW test</em> will transform the dataset to conduct independent analysis of each subset of elements marked as "YES" or with a specific subset name in each <em>subset_x</em> column.</p></li>
<li><p>As many informative columns as needed by users to contextualize the results of each test. The names of these columns should not contain the terms <em>bias_value</em> or <em>subset</em>. While these columns are optional when running a single test, at least one column is required when running multiple tests simultaneously. All rows for each individual test must contain the same information in these columns.</p></li>
<li><p>Users can specify columns with information relevant about each element or row using the column name structure <em>element_x</em>, where <em>x</em> indicates the specific information in each column (see example). However, <em>element_x</em> columns are not essential for bMCW testing and will not be included in the results file.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Path for the local CSV file containing the entry dataset formatted for bMCW tests.</p></dd>


<dt id="arg-max-rearrangements">max_rearrangements<a class="anchor" aria-label="anchor" href="#arg-max-rearrangements"></a></dt>
<dd><p>User-defined maximum number of rearrangements of the dataset used by the function <em>bMCWtest</em> to generate a collection of expected-by-chance bMCW_wBIs and bMCW_sBIs and estimate the statistical significance of observed bMCW_BIs. If the number of distinct dataset rearrangements is less than <em>max_rearrangements</em>, <em>bMCWtest</em> calculates bMCW_wBIs and bMCW_sBIs for all possible data rearrangements. If the number of distinct dataset rearrangements is greater than <em>max_rearrangements</em>, <em>bMCWtest</em> will perform N = <em>max_rearrangements</em> random measure rearrangements to calculate the collection of expected-by-chance bMCW_wBIs and bMCW_sBIs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <em>bMCWtest</em> function reports to the console the total number of tests it will execute, and their exact and approximated counts. It also creates a CSV file named <em>X_bMCWtest_results.csv</em>, where <em>X</em> is a user-defined identifier for the entry dataset CSV file. The <em>X_bMCWtest_results.csv</em> file contains one row for each bMCWtest to indicate the results of whole-set bMCW testing, and as many rows as necessary to indicate the results of subset bMCW testing. Rows for whole-set analyses will be at the top of <em>X_bMCWtest_results.csv</em> file. The <em>X_bMCWtest_results.csv</em> file includes the following columns:</p><ul><li><p>User-provided informative columns to contextualize the results of each test.</p></li>
<li><p>Column <em>subset_type</em> indicates whether the results in each row corresponds to <em>whole-set</em> tests or specific <em>subset</em> tests, such as "chr" for chromosomes or "GO" for Gene Ontology terms.</p></li>
<li><p>Column <em>tested_subset</em> indicates the name of the subset under analysis. For <em>whole-set</em> tests, the <em>tested_subset</em> column indicates "none". For subset tests, the <em>tested_subset</em> column indicates "YES" or the specific name of the subset under analysis, such as "chr1" or "chrX".</p></li>
<li><p>Columns <em>N</em> and <em>n</em> indicate the total number of elements in the whole set and those associated with the subset under analysis, respectively, after removing missing values (NAs). For <em>whole-set</em> tests, columns <em>N</em> and <em>n</em> have the same value.</p></li>
<li><p>Column <em>test_type</em> distinguishes between exact and approximated tests.</p></li>
<li><p>Column <em>BI_type</em> indicates whether results correspond to <em>whole-set</em> tests (bMCW_wBI) or to <em>subset</em> tests (bMCW_sBIs).</p></li>
<li><p>Column <em>observed_BI</em> contains the value of bMCW_BIs obtained from analyzing the user-provided dataset.</p></li>
<li><p>Column <em>expected_by_chance_BI_N</em> indicates the number of data rearrangements used to calculate the expected-by-chance bMCW_wBIs and bMCW_sBIs. This value corresponds to the lowest number between all possible measure rearrangements and the parameter <em>max_rearrangements</em>.</p></li>
<li><p>Columns <em>pupper</em> and <em>plower</em> represent the <em>P~upper~</em> and <em>P~lower~</em> values, respectively. They denote the fraction of expected-by-chance bMCW_wBIs or bMCW_sBIs with values higher or equal to and lower or equal to the observed bMCW_wBIs or bMCW_sBIs, respectively.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <em>bMCWtest</em> eliminates missing values (NAs) from the dataset before proceeding with the following steps.</p><ul><li><p>To estimate the bias for all bias measures in the entire dataset or a subset of them, the function <em>bMCWtest</em> performs the following tasks:</p><ul><li><p>It ranks all bias measures with non-zero values from lowest to highest. Bias measures with a value of 0 are assigned a 0 rank. If multiple bias measures have the same absolute value, all tied bias measures are asssigned the lowest rank possible.</p></li>
<li><p>It assigns each rank a sign based on the sign of its corresponding bias measure.</p></li>
<li><p>It calculates a whole-set bias index (bMCW_wBI) by summing the signed ranks for all elements in the dataset and dividing it by the maximum number that sum could have if all bias measures were positive. Consequently, bMCW_wBI ranges between 1 when all bias measures are positive, and -1 when all bias measures are negative.</p></li>
<li><p>It calculates a subset bias index (bMCW_sBI) for each subset of elements under analysis by summing the signed ranks for the elements in the subset and dividing it by the maximum number that sum could have if the elements in the subset had the highest possible positive bias measures. Consequently, bMCW_sBI ranges between 1 when the bias measures for the subset in question have the highest positive bias measures in the entire dataset, and -1 when the bias measures for the subset in question have the lowest negative bias measures in the entire dataset.</p></li>
</ul></li>
<li><p>To assess the significance of the bMCW-wBIs and bMCW-sBIs obtained from the user-provided dataset (observed bMCW-wBIs and bMCW-sBIs), the function <em>bMCWtest</em> performs the following tasks,</p><ul><li><p>It generates a collection of expected-by-chance bMCW_wBIs by rearranging the signs of all signed ranks multiple times. The function <em>bMCWtest</em> also generates a collection of expected-by-chance bMCW_sBIs by rearranging the subset of elements multiple times. The user-provided parameter <em>max_rearrangements</em> determines the two paths that the function <em>bMCWtest</em> can follow to generate the collection of expected-by-chance bMCW_wBIs and bMCW_sBIs:</p><ul><li><p><em>bMCW exact testing</em>: If the number of distinct bias measure rearrangements that can alter their initial sign distribution or subset distribution is less than <em>max_rearrangements</em>, the function <em>bMCWtest</em> calculates bMCW_wBIs or bMCW_sBIs for all possible data rearrangements.</p></li>
<li><p><em>bMCW approximated testing</em>: If the number of distinct bias measure rearrangements that can alter their initial sign distribution or subset distribution is greater than <em>max_rearrangements</em>, the function <em>bMCWtest</em> performs N = <em>max_rearrangements</em> random measure rearrangements to calculate the collection of expected-by-chance bMCW_wBIs or bMCW_sBIs.</p></li>
</ul></li>
<li><p>It calculates <em>P~upper~</em> and <em>P~lower~</em> values, as the fraction of expected-by-chance bMCW-wBIs and bMCW-sBIs that are higher or equal to and lower or equal to the observed bMCW-wBIs and bMCW-sBIs, respectively.</p></li>
</ul></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">test_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">extdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_bMCWtest_data.csv"</span>, package <span class="op">=</span> <span class="st">"MCWtests"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">extdata</span>, <span class="va">test_temp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># running bMCWtest with an ideal entry dataset</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">test_temp</span>, <span class="st">"example_bMCWtest_data.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bMCWtest_results</span> <span class="op">&lt;-</span> <span class="fu">bMCWtest</span><span class="op">(</span><span class="va">path</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total number of tests: 15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> number of wholeset exact tests: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> number of subset exact tests: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> number of wholeset approximated tests: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> number of subset approximated tests: 12</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> running approximated tests: </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bMCWtest_results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     contrast contrast_trait bias_measure condition_contrast subset_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;char&gt;         &lt;char&gt;       &lt;char&gt;             &lt;char&gt;      &lt;fctr&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        I        trait_a      uMCW_BI          AAAA-BBBB    wholeset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:       II        trait_b      uMCW_BI          AAAA-BBBB    wholeset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:      III        trait_c      uMCW_BI          AAAA-BBBB    wholeset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        I        trait_a      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        I        trait_a      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        I        trait_a      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        I        trait_a      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:       II        trait_b      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:       II        trait_b      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       II        trait_b      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       II        trait_b      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:      III        trait_c      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:      III        trait_c      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:      III        trait_c      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:      III        trait_c      uMCW_BI          AAAA-BBBB  subset_chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tested_subset     N     n    test_type  BI_type observed_BI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;char&gt; &lt;int&gt; &lt;int&gt;       &lt;char&gt;   &lt;char&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:          none    10    10 approximated bMCW_wBI  -0.1636364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:          none    10    10 approximated bMCW_wBI   0.8545455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:          none    10    10 approximated bMCW_wBI   0.2363636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:          chr1    10     3 approximated bMCW_sBI   0.4444444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:          chr2    10     3 approximated bMCW_sBI  -0.2592593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:          chrX    10     3 approximated bMCW_sBI  -0.5555556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:          chrY    10     1 approximated bMCW_sBI   0.1000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:          chr1    10     3 approximated bMCW_sBI   0.4444444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:          chr2    10     3 approximated bMCW_sBI   0.7777778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:          chrX    10     3 approximated bMCW_sBI   0.6296296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:          chrY    10     1 approximated bMCW_sBI  -0.3000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:          chr1    10     3 approximated bMCW_sBI   1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:          chr2    10     3 approximated bMCW_sBI   0.1481481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:          chrX    10     3 approximated bMCW_sBI  -0.4814815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:          chrY    10     1 approximated bMCW_sBI  -0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     expected_by_chance_BI_N pupper plower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;int&gt;  &lt;num&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                      10    0.4    0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                      10    0.0    1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                      10    0.0    1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                      10    0.1    0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                      10    0.4    0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                      10    1.0    0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                      10    0.4    0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                      10    0.4    0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                      10    0.3    0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                      10    0.5    0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                      10    1.0    0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                      10    0.0    1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                      10    0.2    0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                      10    1.0    0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                      10    0.9    0.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">test_temp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlos Diaz-Castillo, Raquel Chamorro-Garcia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

